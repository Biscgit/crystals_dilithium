q = 8380417
n = 256
zeta = 1753
QINV = 58728449
R = 1 << 32


def bitrev(x, bits):
    r = 0
    for _ in range(bits):
        r = (r << 1) | (x & 1)
        x >>= 1
    return r


def mont_reduce(a: int) -> int:
    t = (a * QINV) & 0xFFFFFFFF
    t = (a - t * q) >> 32
    return t


def rev_mont_reduce(a: int) -> int:
    return (a << 32) % q


zetas = [
    0,
    25847,
    5771523,
    7861508,
    237124,
    7602457,
    7504169,
    466468,
    1826347,
    2353451,
    8021166,
    6288512,
    3119733,
    5495562,
    3111497,
    2680103,
    2725464,
    1024112,
    7300517,
    3585928,
    7830929,
    7260833,
    2619752,
    6271868,
    6262231,
    4520680,
    6980856,
    5102745,
    1757237,
    8360995,
    4010497,
    280005,
    2706023,
    95776,
    3077325,
    3530437,
    6718724,
    4788269,
    5842901,
    3915439,
    4519302,
    5336701,
    3574422,
    5512770,
    3539968,
    8079950,
    2348700,
    7841118,
    6681150,
    6736599,
    3505694,
    4558682,
    3507263,
    6239768,
    6779997,
    3699596,
    811944,
    531354,
    954230,
    3881043,
    3900724,
    5823537,
    2071892,
    5582638,
    4450022,
    6851714,
    4702672,
    5339162,
    6927966,
    3475950,
    2176455,
    6795196,
    7122806,
    1939314,
    4296819,
    7380215,
    5190273,
    5223087,
    4747489,
    126922,
    3412210,
    7396998,
    2147896,
    2715295,
    5412772,
    4686924,
    7969390,
    5903370,
    7709315,
    7151892,
    8357436,
    7072248,
    7998430,
    1349076,
    1852771,
    6949987,
    5037034,
    264944,
    508951,
    3097992,
    44288,
    7280319,
    904516,
    3958618,
    4656075,
    8371839,
    1653064,
    5130689,
    2389356,
    8169440,
    759969,
    7063561,
    189548,
    4827145,
    3159746,
    6529015,
    5971092,
    8202977,
    1315589,
    1341330,
    1285669,
    6795489,
    7567685,
    6940675,
    5361315,
    4499357,
    4751448,
    3839961,
    2091667,
    3407706,
    2316500,
    3817976,
    5037939,
    2244091,
    5933984,
    4817955,
    266997,
    2434439,
    7144689,
    3513181,
    4860065,
    4621053,
    7183191,
    5187039,
    900702,
    1859098,
    909542,
    819034,
    495491,
    6767243,
    8337157,
    7857917,
    7725090,
    5257975,
    2031748,
    3207046,
    4823422,
    7855319,
    7611795,
    4784579,
    342297,
    286988,
    5942594,
    4108315,
    3437287,
    5038140,
    1735879,
    203044,
    2842341,
    2691481,
    5790267,
    1265009,
    4055324,
    1247620,
    2486353,
    1595974,
    4613401,
    1250494,
    2635921,
    4832145,
    5386378,
    1869119,
    1903435,
    7329447,
    7047359,
    1237275,
    5062207,
    6950192,
    7929317,
    1312455,
    3306115,
    6417775,
    7100756,
    1917081,
    5834105,
    7005614,
    1500165,
    777191,
    2235880,
    3406031,
    7838005,
    5548557,
    6709241,
    6533464,
    5796124,
    4656147,
    594136,
    4603424,
    6366809,
    2432395,
    2454455,
    8215696,
    1957272,
    3369112,
    185531,
    7173032,
    5196991,
    162844,
    1616392,
    3014001,
    810149,
    1652634,
    4686184,
    6581310,
    5341501,
    3523897,
    3866901,
    269760,
    2213111,
    7404533,
    1717735,
    472078,
    7953734,
    1723600,
    6577327,
    1910376,
    6712985,
    7276084,
    8119771,
    4546524,
    5441381,
    6144432,
    7959518,
    6094090,
    183443,
    7403526,
    1612842,
    4834730,
    7826001,
    3919660,
    8332111,
    7018208,
    3937738,
    1400424,
    7534263,
    1976782,
]


def ntt(a: list[int]) -> list[int]:
    m = 0
    len = n >> 1
    while len >= 1:
        start = 0
        while start < n:
            m += 1
            z = zetas[m]
            for j in range(start, start + len):
                t = mont_reduce(z * a[j + len])
                a[j + len] = a[j] - t
                a[j] = a[j] + t
            start += 2 * len
        len >>= 1
    return [x % q for x in a]


if "__main__" == __name__:
    print(
        ntt(
            [
                7038168,
                4193173,
                7085032,
                4158962,
                6012315,
                4013021,
                6115917,
                5928675,
                7075316,
                3937349,
                880280,
                8176627,
                893789,
                6576444,
                6575676,
                4062841,
                3710971,
                5149808,
                1065575,
                5918588,
                4364641,
                689952,
                1916869,
                6961268,
                6476142,
                2322755,
                4863002,
                2774535,
                7422378,
                7301770,
                353514,
                5527476,
                7684287,
                2024372,
                5745435,
                5408524,
                5567492,
                7461918,
                6440578,
                6998354,
                1401800,
                5802268,
                1147043,
                3544123,
                8177658,
                8098622,
                7184480,
                5798167,
                3499537,
                3180042,
                7760119,
                1834143,
                6779626,
                2561220,
                4680899,
                4807684,
                6401056,
                5826255,
                4224689,
                2220705,
                1041151,
                4284304,
                585246,
                920439,
                5894892,
                7349867,
                2648125,
                6105354,
                4970683,
                7221751,
                5794606,
                3179877,
                1696030,
                6389119,
                170417,
                1405103,
                8173756,
                6001883,
                4133800,
                99722,
                710143,
                6949105,
                392949,
                3087718,
                3920539,
                4372622,
                2660684,
                5373427,
                3958297,
                1809743,
                492225,
                2669069,
                1597949,
                7221775,
                3138003,
                1658198,
                5335393,
                5602406,
                3591883,
                543948,
                1568440,
                8928,
                7213845,
                958249,
                1477166,
                7964723,
                4062701,
                1660721,
                3168983,
                6485241,
                1113713,
                7601804,
                4496400,
                3317365,
                6654375,
                8233360,
                5734272,
                8135774,
                5156794,
                3743201,
                5642859,
                6454329,
                1721209,
                1992315,
                3026940,
                35819,
                4479738,
                5200117,
                351763,
                7044062,
                8133687,
                3483585,
                8293122,
                736543,
                2167641,
                6593339,
                3107586,
                869296,
                5848665,
                2358419,
                1771330,
                1919698,
                1461310,
                7319493,
                6648718,
                5597648,
                4748346,
                2941919,
                7772750,
                5429605,
                1089691,
                7874488,
                187620,
                1073537,
                5908902,
                6607566,
                7526371,
                7867037,
                86970,
                8313833,
                1358384,
                4803126,
                6372840,
                2556982,
                5471865,
                5117525,
                3937876,
                5734037,
                7340929,
                4157231,
                7566414,
                5242933,
                596379,
                1522116,
                2053884,
                3150974,
                5620481,
                3180543,
                5904515,
                1061465,
                3730078,
                1696005,
                5667430,
                1538876,
                8016479,
                4726440,
                2521765,
                7866845,
                1899363,
                978766,
                2442645,
                3073770,
                7693369,
                6109986,
                232283,
                7927781,
                4928713,
                416761,
                308970,
                875117,
                7968086,
                5416600,
                717735,
                7798544,
                6958184,
                420021,
                3437489,
                853758,
                3145603,
                4129623,
                5900822,
                1521296,
                1742036,
                1946488,
                5605830,
                5153798,
                7819375,
                689567,
                1370564,
                2832023,
                2769630,
                3499712,
                2899141,
                3738747,
                7509596,
                3320067,
                5332485,
                1047449,
                3626703,
                7950452,
                3498218,
                8334557,
                2824960,
                4951468,
                6182818,
                3037921,
                1405326,
                5628031,
                7257637,
                2765458,
                8075481,
                6991205,
                931076,
                5479086,
                8204517,
                6774417,
                4554010,
                2156255,
                7327438,
                3394746,
                418868,
                7287118,
                8343692,
                7657108,
                8349009,
                5574367,
            ]
        )
    )
