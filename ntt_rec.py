q = 8380417
n = 256
zeta = 1753
QINV = 58728449
R = 1 << 32


def bitrev(x, bits):
    r = 0
    for _ in range(bits):
        r = (r << 1) | (x & 1)
        x >>= 1
    return r


def mont_reduce(a: int) -> int:
    t = a * QINV
    t = t & 0xFFFFFFFF
    t = (a - t * q) >> 32
    return t


def rev_mont_reduce(a: int) -> int:
    return (a << 32) % q


zetas = [
    4193792,
    2091667,
    4450022,
    7100756,
    2706023,
    342297,
    5037034,
    5341501,
    2725464,
    900702,
    3412210,
    6366809,
    6681150,
    4613401,
    189548,
    5441381,
    1826347,
    266997,
    7122806,
    7838005,
    4519302,
    2842341,
    4656075,
    7953734,
    6262231,
    7725090,
    7709315,
    5196991,
    811944,
    7047359,
    1285669,
    7826001,
    237124,
    5037939,
    6927966,
    1500165,
    6718724,
    3437287,
    44288,
    2213111,
    7830929,
    495491,
    5412772,
    1957272,
    3507263,
    5386378,
    5971092,
    183443,
    3119733,
    4860065,
    5190273,
    5796124,
    3539968,
    4055324,
    2389356,
    6712985,
    1757237,
    4823422,
    7998430,
    810149,
    3900724,
    7929317,
    5361315,
    3937738,
    5771523,
    2316500,
    4702672,
    5834105,
    3077325,
    5942594,
    508951,
    3866901,
    7300517,
    909542,
    2147896,
    2454455,
    3505694,
    2635921,
    3159746,
    7959518,
    8021166,
    7144689,
    4296819,
    6709241,
    3574422,
    5790267,
    1653064,
    6577327,
    6980856,
    2031748,
    8357436,
    1616392,
    954230,
    5062207,
    7567685,
    8332111,
    7504169,
    5933984,
    2176455,
    2235880,
    5842901,
    1735879,
    904516,
    1717735,
    2619752,
    8337157,
    7969390,
    185531,
    6779997,
    1903435,
    1315589,
    1612842,
    3111497,
    7183191,
    4747489,
    594136,
    2348700,
    2486353,
    759969,
    8119771,
    4010497,
    7611795,
    1852771,
    4686184,
    2071892,
    3306115,
    4751448,
    7534263,
    25847,
    3407706,
    6851714,
    1917081,
    95776,
    286988,
    264944,
    3523897,
    1024112,
    1859098,
    7396998,
    2432395,
    6736599,
    1250494,
    4827145,
    6144432,
    2353451,
    2434439,
    1939314,
    5548557,
    5336701,
    2691481,
    8371839,
    1723600,
    4520680,
    5257975,
    7151892,
    162844,
    531354,
    1237275,
    6795489,
    3919660,
    7602457,
    2244091,
    3475950,
    777191,
    4788269,
    5038140,
    7280319,
    7404533,
    7260833,
    6767243,
    4686924,
    3369112,
    6239768,
    1869119,
    8202977,
    7403526,
    5495562,
    4621053,
    5223087,
    4656147,
    8079950,
    1247620,
    8169440,
    7276084,
    8360995,
    7855319,
    1349076,
    1652634,
    5823537,
    1312455,
    4499357,
    1400424,
    7861508,
    3817976,
    5339162,
    7005614,
    3530437,
    4108315,
    3097992,
    269760,
    3585928,
    819034,
    2715295,
    8215696,
    4558682,
    4832145,
    6529015,
    6094090,
    6288512,
    3513181,
    7380215,
    6533464,
    5512770,
    1265009,
    5130689,
    1910376,
    5102745,
    3207046,
    7072248,
    3014001,
    3881043,
    6950192,
    6940675,
    7018208,
    466468,
    4817955,
    6795196,
    3406031,
    3915439,
    203044,
    3958618,
    472078,
    6271868,
    7857917,
    5903370,
    7173032,
    3699596,
    7329447,
    1341330,
    4834730,
    2680103,
    5187039,
    126922,
    4603424,
    7841118,
    1595974,
    7063561,
    4546524,
    280005,
    4784579,
    6949987,
    6581310,
    5582638,
    6417775,
    3839961,
    1976782,
]


def ntt(a: list[int], zeta_expo: int) -> list[int]:
    zeta = zetas[zeta_expo]
    if len(a) == 64:
        return [a[0]]
    print()
    print()
    i = 1
    print(zeta)
    print(a[i], a[len(a) // 2 + i])
    t = zeta * a[len(a) // 2 + i]
    print(t)
    x = mont_reduce(t)
    print(x)
    print()
    print((a[i] + x))
    print((a[i] - x))
    print()
    print((a[i] + x) % q)
    print((a[i] - x) % q)
    ts = [mont_reduce(zeta * a[len(a) // 2 + i]) for i in range(len(a) // 2)]

    sub_a0 = [x + t for x, t in zip(a, ts)]
    # sub_a1 = [x - t for x, t in zip(a, ts)]
    left_node = ntt(sub_a0, zeta_expo // 2)

    return a
    # rigth_node = ntt(sub_a1, zeta_expo // 2 + n // 2)

    # return left_node + rigth_node


if "__main__" == __name__:
    result = ntt(
        [
            7038168,
            4193173,
            7085032,
            4158962,
            6012315,
            4013021,
            6115917,
            5928675,
            7075316,
            3937349,
            880280,
            8176627,
            893789,
            6576444,
            6575676,
            4062841,
            3710971,
            5149808,
            1065575,
            5918588,
            4364641,
            689952,
            1916869,
            6961268,
            6476142,
            2322755,
            4863002,
            2774535,
            7422378,
            7301770,
            353514,
            5527476,
            7684287,
            2024372,
            5745435,
            5408524,
            5567492,
            7461918,
            6440578,
            6998354,
            1401800,
            5802268,
            1147043,
            3544123,
            8177658,
            8098622,
            7184480,
            5798167,
            3499537,
            3180042,
            7760119,
            1834143,
            6779626,
            2561220,
            4680899,
            4807684,
            6401056,
            5826255,
            4224689,
            2220705,
            1041151,
            4284304,
            585246,
            920439,
            5894892,
            7349867,
            2648125,
            6105354,
            4970683,
            7221751,
            5794606,
            3179877,
            1696030,
            6389119,
            170417,
            1405103,
            8173756,
            6001883,
            4133800,
            99722,
            710143,
            6949105,
            392949,
            3087718,
            3920539,
            4372622,
            2660684,
            5373427,
            3958297,
            1809743,
            492225,
            2669069,
            1597949,
            7221775,
            3138003,
            1658198,
            5335393,
            5602406,
            3591883,
            543948,
            1568440,
            8928,
            7213845,
            958249,
            1477166,
            7964723,
            4062701,
            1660721,
            3168983,
            6485241,
            1113713,
            7601804,
            4496400,
            3317365,
            6654375,
            8233360,
            5734272,
            8135774,
            5156794,
            3743201,
            5642859,
            6454329,
            1721209,
            1992315,
            3026940,
            35819,
            4479738,
            5200117,
            351763,
            7044062,
            8133687,
            3483585,
            8293122,
            736543,
            2167641,
            6593339,
            3107586,
            869296,
            5848665,
            2358419,
            1771330,
            1919698,
            1461310,
            7319493,
            6648718,
            5597648,
            4748346,
            2941919,
            7772750,
            5429605,
            1089691,
            7874488,
            187620,
            1073537,
            5908902,
            6607566,
            7526371,
            7867037,
            86970,
            8313833,
            1358384,
            4803126,
            6372840,
            2556982,
            5471865,
            5117525,
            3937876,
            5734037,
            7340929,
            4157231,
            7566414,
            5242933,
            596379,
            1522116,
            2053884,
            3150974,
            5620481,
            3180543,
            5904515,
            1061465,
            3730078,
            1696005,
            5667430,
            1538876,
            8016479,
            4726440,
            2521765,
            7866845,
            1899363,
            978766,
            2442645,
            3073770,
            7693369,
            6109986,
            232283,
            7927781,
            4928713,
            416761,
            308970,
            875117,
            7968086,
            5416600,
            717735,
            7798544,
            6958184,
            420021,
            3437489,
            853758,
            3145603,
            4129623,
            5900822,
            1521296,
            1742036,
            1946488,
            5605830,
            5153798,
            7819375,
            689567,
            1370564,
            2832023,
            2769630,
            3499712,
            2899141,
            3738747,
            7509596,
            3320067,
            5332485,
            1047449,
            3626703,
            7950452,
            3498218,
            8334557,
            2824960,
            4951468,
            6182818,
            3037921,
            1405326,
            5628031,
            7257637,
            2765458,
            8075481,
            6991205,
            931076,
            5479086,
            8204517,
            6774417,
            4554010,
            2156255,
            7327438,
            3394746,
            418868,
            7287118,
            8343692,
            7657108,
            8349009,
            5574367,
        ],
        n // 2,
    )
    (print([x % q for x in result]),)

# 3793945, 2905218, 7185398, 7652020, 6135506, 8154401, 5123310, 4381726, 6521874, 3410369, 2874853, 2996835, 7618627, 737810, 1570008, 6974392, 1375053, 5119930, 1828259, 1853103, 8195978, 2944557, 346816, 6521149, 1010886, 368945, 5174254, 7681372, 3126949, 2755372, 132310, 810655, 5386986, 6722514, 5457913, 2467585, 7620395, 2587913, 7320136, 7434601, 5230243, 699008, 2588455, 64466, 8046951, 5033033, 6562963, 4328051, 652749, 450017, 3026342, 2509995, 1288290, 4915680, 1735826, 6768633, 3339392, 2715674, 7157089, 5220566, 1689547, 1264348, 4068159, 6221024, 4513852, 2712153, 1414452, 2508828, 689132, 6373257, 5423640, 1794572, 2145254, 112957, 7508131, 1761694, 7764012, 1415628, 5372076, 1027510, 5964544, 3074732, 416917, 454761, 427077, 1522886, 7523199, 3345809, 2153904, 7518138, 5685173, 302814, 6539141, 4017523, 2565515, 6617226, 3186013, 4058511, 7709249, 3413652, 3252726, 7587890, 6022105, 4516577, 4979882, 2914720, 6999657, 2533559, 2929993, 241532, 132146, 1572175, 7664310, 7973330, 2846278, 3288929, 4217660, 2398423, 6125424, 3254525, 2806437, 5698905, 5137046, 972101, 1795719, 641172, 6323223, 4174330, 8116078, 5894359, 6117598, 2348330, 4635402, 7907877, 2573304, 1327556, 8101592, 7795317, 4358443, 5977715, 6781434, 7519018, 7986829, 5816954, 4464167, 1528953, 4000518, 723968, 3749056, 138456, 3112786, 4140101, 3523827, 3815206, 1403625, 5939734, 6329043, 4043443, 924066, 5251679, 6526207, 8083729, 925456, 7550031, 1372913, 930766, 5363414, 436540, 7962783, 2054698, 3319569, 5565894, 8336765, 6916779, 6538156, 3067370, 4512388, 2103233, 4915109, 7259341, 7671996, 2491276, 7841879, 5390766, 2040889, 3349125, 1122203, 5486718, 3526523, 2633942, 3456727, 667402, 1734552, 3251917, 6743758, 6501245, 3939193, 7708546, 6054289, 6682520, 8033077, 7058536, 3282135, 2073430, 306629, 104661, 1097383, 2186242, 3068555, 7228584, 5260301, 7497651, 373116, 507283, 909361, 3533128, 6731238, 5529335, 7972438, 2348233, 5974191, 138434, 2223754, 3885248, 7625158, 5219820, 1606467, 6111359, 1646676, 8355354, 2864685, 4695071, 1549855, 1676338, 113511, 4084351, 2057497, 2610790, 7137268, 6102206, 4153333, 5808211, 2685707, 613388, 2051390, 6727737, 5208189, 4329651, 7550460, 7064447, 1494900, 3313324, 4050144, 3021567, 8033187, 5495884
# 3527686, 1930588, 3109133, 5864302, 5046357, 7180728, 3677363, 7402123, 5452393, 3068822, 4177592, 3754672, 6441119, 834830, 5593069, 1346096, 7433690, 5248240, 7381866, 5971261, 2848352, 7529224, 2276516, 3969301, 6655674, 4238398, 5688288, 578381, 3165083, 2101219, 1859125, 350328, 1444633, 7300910, 825594, 6641300, 4108858, 2293463, 8138518, 5193831, 6105516, 8002591, 3579763, 2793597, 6321434, 5400270, 2649898, 3691205, 2584629, 6544632, 3227508, 1259002, 2295618, 8102371, 1360611, 8073986, 1865209, 3686036, 7018127, 90248, 4184999, 3178362, 6316209, 942974, 7598964, 715087, 4306691, 4000008, 3941721, 1634590, 7963527, 3320444, 6674293, 1141916, 6067728, 5018938, 2639694, 737792, 1519410, 2308218, 3486301, 7925840, 257492, 1159264, 3014871, 8339346, 6435658, 8272944, 2746133, 4855141, 6830334, 358101, 6965575, 3249763, 3852118, 2963416, 5103527, 5083259, 6246892, 2527734, 292616, 3079781, 2297553, 435031, 1622203, 208731, 6995597, 3110387, 6129298, 3534259, 5385553, 7385850, 3809136, 1280785, 491589, 1234377, 4131310, 6398603, 7637128, 6716713, 8351908, 3833405, 4218043, 5270090, 4490416, 1423582, 3299068, 2746643, 1431861, 5157381, 3314567, 7570866, 4740801, 7575541, 7318172, 4174501, 6127722, 584320, 4093870, 1041095, 352307, 820593, 4435463, 6813754, 223597, 1660151, 1345453, 7490166, 1161820, 8198582, 3881731, 6440531, 7650119, 1569674, 6292111, 432814, 2351228, 3023258, 7437575, 1195476, 3735152, 1483424, 4480029, 5156627, 1057805, 3022359, 7248927, 1355602, 1804737, 680166, 215020, 1734798, 3810080, 8142052, 7684391, 820393, 7490854, 3634292, 7457280, 112414, 3780885, 6257111, 2185076, 3696558, 7172198, 5071839, 5212423, 8256215, 1126156, 6741083, 7271950, 5410663, 987434, 680684, 7655449, 4178692, 8222360, 2038722, 2199954, 1146935, 4442265, 7197356, 5108430, 7688998, 4752779, 6964992, 448449, 1239143, 5939096, 801295, 1187578, 6251498, 7089901, 5069566, 3271164, 4319075, 6107991, 7353098, 3184631, 4876982, 255170, 5011433, 245355, 6446093, 7096027, 3637946, 5019147, 6567199, 5165127, 2891287, 1746549, 1853072, 8016272, 94745, 8050390, 6746713, 2050347, 863793, 7467259, 5434527, 7126217, 594550, 4873370, 2907134, 6448770, 2781075, 4155076, 868921, 995631, 6152978, 7846396, 5934588, 3419660, 3415933, 2593000, 5525863
# 16964146
# 8828404
# 10557284
# 8496130
# 19792162
# 22280048
# 11770375
# 17904771
# 14407690
# 19370718
# 15762997
# 12945091
# 21200064
# 12873656
# 18631567
# 10857153
# 11141175
# 9366193
# 10642201
# 12194199
# 20437266
# 13592300
# 21662274
# 14852464
# 1133027
# 4297801
# 7550549
# 12973055
# 3544853
# 4179675
# 7171412
# 12021188
# 5516557
# 11905143
# 7766429
# 14975659
# 8860699
# 4436669
# 10016470
# 5290518
# 3777383
# -3639905
# 4826988
# 9112366
# -2504516
# 2868786
# -636272
# -530174
# 6716887
# 7728357
# 5515510
# 3563830
# 18696248
# 15773592
# 7938342
# 12524106
# 19853930
# 13790814
# 18064016
# 20219116
# 12825868
# 4674698
# 10676311
# 18250775
# 4693336
# -251598
# 6539960
# -1552578
# 2902102
# 8618190
# -250084
# 6845248
# 9183197
# 815911
# 510282
# 2743286
# 188348
# 5154986
# 12170965
# 4270417
# 21206507
# 23404995
# 15629631
# 15471299
# 15402274
# 9643580
# 7049785
# 13716673
# 1194696
# 7414518
# 10746483
# 6974647
# 13854032
# 10363404
# 7754452
# 3835088
# 6708367
# 4218321
# 979454
# 6504174
# 3858747
# 4124453
# 7457665
# 10335619
# 2167597
# 8671157
# 4432387
# 3175147
# 1942705
# 6079071
# -408377
# -2416103
# 9172347
# 10660153
# 16263442
# 8597170
# 10623730
# 2980038
# 3506400
# 3320328
# 4654768
# -2315986
# 12439720
# 6559690
# 4416964
# 7589990
# -4487049
# 2674823
# 8034428
# 5333298
# -1122436
# -710766
# -3122407
# -3426525
# -3495601
# 751577
# -11780890
# -4755504
# -11361051
# -8304739
# -5076491
# -4273807
# 562177
# -4382623
# -6366825
# -12659157
# -13226671
# -9434299
# -5339113
# -7067415
# -7859166
# -27274
# -16134875
# -11697111
# -10213893
# -8103577
# -4157877
# -10948339
# -11698016
# -10360920
# -7984406
# -7514314
# -3810352
# -3301828
# -2644217
# 929687
# 4002775
# -3218025
# -7483076
# 430164
# -4059670
# -4479354
# -5389025
# -7971343
# -10688046
# -11211594
# -1263006
# 5668486
# 613631
# 7929821
# 5293323
# -1579661
# 4144966
# 2757480
# -3136684
# 1520156
# 885182
# 3306718
# -1622242
# -634148
# 8680041
# 2968625
# 14283486
# 13028474
# 6065879
# 9072001
# -2591696
# 3685338
# 6826734
# 8698824
# 5899566
# 5151522
# -1358608
# 6913060
# -5567375
# -5375699
# 2063946
# -1711676
# -4528092
# -1510594
# -7789977
# -10644901
# 1061237
# 1308159
# -3554476
# -7674436
# 120500
# 6644002
# 11718304
# 8270326
# 4982986
# 5145634
# -798074
# -4571686
# -233914
# 6936916
# 5343685
# 9436777
# 4555089
# 4412117
# 1953759
# 9892547
# 6254103
# 1081309
# 10817804
# 5075260
# 4613840
# 11826836
# 17514376
# 14004184
# 2718345
# -16297
# -2617425
# -5059755
# 1741391
# 40277
# 7562126
# 6452274
# 10526147
# 17147421
# 3992666
# 8427022
# 4674821
# 5907545
# 11168623
# 14530163
